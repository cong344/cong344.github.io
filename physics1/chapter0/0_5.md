<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

### 0.5 单元函数微积分

牛顿在其著作《自然哲学的数学原理》中提出了微积分。自此，人类得以用微分与积分的思想来描述整个客观世界。单元函数是由一个自变量控制其值的函数，本节中介绍对单元函数进行的微积分运算。

#### 0.5.1 从极限谈起

微积分是基于极限的学说。从阿喀琉斯和他的乌龟起，极限的概念在科学史上留下了太多的悖论。正是客观真实世界的连续性以及物理模型对“无穷”的理想化，才引出了对极限的讨论。在这里，我们不对极限进行严格的定义，而主要讨论关于它的计算。请读者注意，在本节对微积分的讨论中所有的描述都不是严格的，若对数学存在洁癖请查阅相关教材。

在上一节数列的极限中，我们已经知道了数列在无穷远处的极限。同样地，当自变量趋于无穷时，函数的值就是其在无穷远处的极限，记为 $\displaystyle\lim_{x\to\infty}f(x)=L $ 。需要注意的是，对无穷正负性的区分是必要的，即 $+\infty,\ -\infty $ 的极限值可能不同。

当x趋于某一个数轴上的点时，函数的极限同样可以进行描述，数学上使用 $\epsilon-\delta $ 语言。实际上，就是将x无限趋近于一点a，而函数值无限趋近于某一值L，记为 $\displaystyle\lim_{x\to a} f(x)=L $ 。需要注意，从数轴的左侧及右侧趋近的值可能不同，这便引出**左极限**与**右极限**的概念，分别记作 $x\to a^-,\ x\to a^+ $ 。

在物理问题的求解中，所遇的求极限问题大多比较简单，无需引入过于复杂的分析学上求极限的方法。此处，我们只介绍**洛必达法则(L'Hospital's rule)**，可以直接解决大部分极限。

对于分式的极限，其分子或分母至少有一个趋于无穷或0，有：

$$
\lim \frac{f(x)}{g(x)}=\lim\frac{f'(x)}{g'(x)}
$$

对于非分式的极限，大部分能通过取对数，取倒数等方法将其化为分式极限。

#### 0.5.2 导数与微分

物理问题中，常常涉及到“变化率”，导数便是求解这类问题的有效工具。从本质上讲，导数就是一种特别的分式极限，即：

$$
f'(x)=\lim_{\Delta x\to 0}\frac{\Delta y}{\Delta x}
$$

值得一提的是，很多高中教材没有引入微分算符，笔者认为这是完全没有必要的。当 $\Delta x$ 很小的时候，我们将其写作 $\mathrm{d}x $ ，这里的 $\mathrm{d} $ 被称为**微分算符**，而 $\mathrm{d}x $ 被称为**微分**。

由此，我们便得到了导数的微分定义：

$$
f'(x)=\frac{\mathrm{d}y}{\mathrm{d}x}
$$

由此，便得微分的计算方法：

$$
\mathrm{d}y=y'\mathrm{d}x
$$

这种运算对于估算相当有用。例如，若想计算某立体图形表面薄层的体积，只需求出其体积关于某自变量的函数： $V=V(x) $ ，从而有 $\mathrm{d}V=V'(x)\mathrm{d}x $ 。

另外，牛顿对导数的写法为在字母上加点，例如y的导数记作 $\dot{y}$ ，而n阶导数则表示为 $y^{(n)} $ 。另一种导数的记法引入了导数算子 $D=\frac{\mathrm{d}}{\mathrm dx} $ ，即y的导数记作 $Dy$ 。

上面所说的导数均是一个**点**的导数，其几何意义为函数图像上一个点切线的斜率。将函数上每个点与其斜率对应将形成一个新的函数，这便称为**导函数**。在下文中，导函数均简称为导数。

![]()

<center>figure 0.8 导数的几何意义</center><br>

关于导数的计算，这里给出一些简单的方法。下文中，u,v是两个函数。

作为一种特殊的运算符，导数满足**线性性质**，即对数乘与加法满足：

$$
(k\cdot u+l\cdot v)'=k\cdot u'+l\cdot v'
$$

导数的乘除法满足**乘法原理**与**除法原理**：

$$
(uv)'=u'v+uv',\quad (\frac{u}{v})'=\frac{u'v-uv'}{v^2}
$$

对于复合函数，形如 $y=f(u),\ u=g(x) $ ，其导数满足**链式法则**：

$$
\frac{\mathrm{d}f(u)}{\mathrm{d}x}=\frac{\mathrm{d}f(u)}{\mathrm{d}u}\cdot \frac{\mathrm{d}u}{\mathrm{d}x}=\frac{\mathrm{d}f(u)}{\mathrm{d}u}\cdot \frac{\mathrm{d}g(x)}{\mathrm{d}x}
$$

对于含较多乘除法或形如 $y=[f(x)]^{g(x)} $ 的复合幂函数，使用**对数求导法**。即对等号两侧同取对数，再同时求导。需要注意的是，在很多情况下，若等式*处处成立*，则可以对等式两侧同时求导。以这样的复合幂函数为例：

$$
\begin{aligned}
\ln y&=g(x)\ln f(x) \\
\frac{1}{y}\frac{\mathrm{d}y}{\mathrm{d}x}&=[g(x)\ln f(x)]'
\end{aligned}
$$

对于初等函数“反对幂指三”，熟记其求导公式是必要的：

$$
(x^n)'=nx^{n-1},\ (a^x)'=a^x\ln a,\ (\log_a x)'=\frac{1}{x\ln a}
$$

对于指数函数与对数函数，当 $a=e$ 时，公式退化为简单的形式，尤其是 $(e^x)'=e^x,\ (\ln x)'=\frac{1}{x} $ 。由此性质，自然对数e亦被称为导数运算的**特征值**。这便是在许多物理过程中均存在e的原因。

三角函数的导数为：

$$
\begin{aligned}
(\sin x)'=\cos x \quad&\quad (\cos x)'=-\sin x\\
(\tan x)'=\sec^2x \quad&\quad (\cot x)'=-\csc^2x\\
(\sec x)'=\sec x\tan x \quad&\quad(\csc x)'=-\csc x\cot x
\end{aligned}
$$

他们可以用下面的口诀来记忆：

<table><td bgcolor=FFFFCC>
正则正，余则负。<br>
弦互换，切割方，割追切。
</table>

对于他们的反函数，只需将导数取倒数，即：

$$
\frac{\mathrm{d}x}{\mathrm{d}y}=\frac{1}{\frac{\mathrm{d}y}{\mathrm{d}x}}
$$

因此，有：

$$
(\arcsin x)'=\frac{1}{\sqrt{1-x^2}},\quad (\arctan x)'=\frac{1}{1+x^2}
$$

在导数的计算中，可以综合应用上述的各种方法，总能得到同一的结果。事实上，不论所求的函数多么复杂，我们总能求得其导数，无非是其计算量较大。

另外，导数的重要意义更在于其与极值的相关性。由导数的几何意义可以看出，当 $f'(x_0)=0 $ 时， $x_0 $ 处必为函数的**极值点**。更进一步地，通过画图不难得到：

$$
\begin{cases}
f''(x_0)>0 \qquad x_0\text{为极大值}\\
f''(x_0)<0 \qquad x_0\text{为极小值}\\
\end{cases}
$$

通过这种方法，判断任意函数的极值均有了一种通用的方法，而无需去追求不等式放缩的“灵机一动”了。

不仅如此，通过导数的正负与函数斜率之间的联系，我们可以简单的画出函数的草图。这是对函数定性分析及求最值的有效方法。

#### 0.5.3 积分

还有一类物理问题，他们需要对物理量进行连续的累加。积分是解决这类问题的手段，他们是一种特别的求和极限，即：

$$
\int_a^b f(x)\mathrm{d}x=\lim_{\Delta x\to0}\sum f(x)\Delta x
$$

可以理解为，积分号 $\int$ 便是求和号 $\sum $ 的“草书”形式。

积分号的几何意义便是求函数图像所围成的面积。由此，对于几何图形简单的函数，可以直接由其几何意义求定积分。例如，一次函数围成直角梯形， $f(x)=\sqrt{1-x^2} $ 描述了一个半径为1的半圆。

![]()

<center>figure 0.9 定积分的几何意义 </center><br>

对于一般的函数，对其应用**牛顿-莱布尼茨公式(Newton-Lebniz Formula)**：

$$
\int_a^b f(x)\mathrm{d}x=F(x)\bigg|_a^b=F(b)-F(a)
$$

其中，F(x)与f(x)之间满足 $F'(x)=f(x) $ ，F(x)称为f(x)的**原函数**。由此可以看出，**积分是导数的逆运算**。

当积分的上下限为一变量时，定积分便是一个函数。这种积分被称为**变上限积分**：(a为一常量)

$$
f(x)=\int_a^t g(t)\mathrm{d}t
$$

若我们单纯对一个函数求原函数，则无需考虑上下限，这被称为函数的**不定积分**。由于一个常数求导数后变为0，因此不定积分的结果是一个**积分曲线族**，即可以将所求的函数进行任意的上下平移。

$$
\int f(x)\mathrm{d}x=F(x)+C
$$

事实上，与导数不同的是，不是所有的函数都可求得积分。很多函数的不定积分无法用解析式表出，他们被称为**不可积**。当然，考虑到其几何意义，一切上下限为有限数的定积分都可求出**数值解**。关于其求解，请学习使用计算机科技。

下面，介绍一些常用的积分求解办法。

对于定积分，要善于利用函数的对称性。事实上，他们很容易由函数图像观察得到。例如，对于在 $[-a,a] $ 上的积分，奇函数的积分值为0，而偶函数可以转换为2倍在 $[0,a] $ 上的积分。

积分的技巧之一为**凑微分法**。由微分的定义，我们有 $f'(x)\mathrm{d}x=\mathrm{d}f(x) $ 。可以看出，其本质是换元，令 $u=f(x) $ 。例如：

$$
\int \sin^3x\mathrm{d}x=\int (1-\cos^2x)\cdot\sin x\mathrm{d}x=-\int(1-\cos^2x)\mathrm{d}\cos x
$$

另一种积分的技巧是**换元法**，这里着重介绍**三角换元法**。这种方法一般在根式中使用。例如：对 $\sqrt{a^2-x^2} $ ，令 $x=a\sin t $ ；对 $\sqrt{a^2+x^2} $ ，令 $x=a\tan t $ 。可以看出，三角换元法的依据来源于我们在0.1中提到的三角函数转换公式。需要注意，这时也要对微分部分进行换元。即：若 $t=\arcsin \frac{x}{a} $ ，则 $\mathrm{d}t=(\arcsin \frac{x}{a})'\mathrm{d}x $

再一种技巧为**分部积分法**。其来自导数的乘法原理： $(uv)'=u'v+uv' $ 。先将其化为微分形式： $\mathrm{d}(uv)=v\mathrm{d}u+u\mathrm{d}v $ ，再将其两侧积分并移项，则有：

$$
\int u\mathrm{d}v=uv-\int v\mathrm{d}u
$$

这种方法用于 $v\mathrm{d}u $ 比 $u\mathrm{d}v$ 更好求解之时。可以看出，分部积分法需要与凑微分法同时使用。在很多情况下，我们需要多次使用分部积分法，这常常用于推理积分的递推式。例如，对于 $\int x^ne^x\mathrm{d}x $ ，需要多次使用 $e^x\mathrm{d}x=\mathrm{d}e^x$ 。

以上是求解积分的一些通法。但与求导的套公式不同，求解积分常常需要一些“巧劲”。因此，笔者不建议在求解物理问题时“死磕”积分，我们应该熟记积分表中一些常见的结论。

由于积分便是导数的逆运算，对于简单的幂指对函数，只需要简单的求导便可知道积分结果，即“瞪眼法”。然而，下面的积分不好直接“瞪眼”得到，却又十分常见：

$$
\begin{aligned}
\int \frac{1}{\sqrt{x^2\pm a^2}}\mathrm{d}x&=\ln(x+\sqrt{x^2\pm a^2})+C\\
\int \frac{1}{x^2+a^2}\mathrm{d}x&=\frac{1}{a}\arctan\frac{x}{a}+C\\
\int \frac{1}{x^2-a^2}\mathrm{d}x&=\frac{1}{2a}\left(\int\frac{1}{x-a}+\int\frac{1}{x+a} \right)
\end{aligned}
$$

对于三角函数，有如下结论：

$$
\begin{aligned}
\int \sin x\mathrm{d}x=-\cos x+C,&\quad \int \cos x\mathrm{d}x=\sin x+C\\
\int \tan x\mathrm{d}x=-\ln|\cos x|+C,&\quad \int \cot x\mathrm{d}x=\ln|\sin x|+C\\
\int \sec x\mathrm{d}x=\ln|\sec x+\tan x|+C,&\quad \int \csc x\mathrm{d}x=\ln|\csc x-\cot x|+C
\end{aligned}
$$

这可用如下口诀记忆：

<table><td bgcolor=FFFFCC>
正反负，余反正。<br>
弦互换，切对弦。<br>
割不变，加减切。
</table>

#### 0.5.4 微分方程

我们都知道，多个未知数组成的等式叫作方程。若将未知数换为**未知函数**，则等式便改称为**微分方程**。在方程中，未知数的最高次数被称为方程的次数。同样地，在微分方程中将出现未知函数的导数，其导数的最高阶数被称为方程的**阶数**。多个方程会组成一个方程组，而多个微分方程则组成一个**微分方程组**。

事实上，物理学上动力学的基本方程就是一个微分方程，即牛顿第二定律： $\vec{F}=m\ddot{\vec{x}} $ 。因此，我们的物理世界中任意物体的运动都是由微分方程描述的。然而，并不是所有微分方程都是可解的。对于一部分微分方程，我们无法得到解析解，但可以通过计算机得到数值解；对于另一部分微分方程，物理学家与数学家们时至今日仍在探寻他们的奥秘，例如著名的Schrödinger Equation(薛定谔方程，量子力学)以及Navier-Stokes equation(纳维-斯托克斯方程，流体力学)。

可见，不是所有微分方程都是我们有能力求解的。在这里，我们介绍几个常见而又可解的微分方程。在下面，我们假设所求解的未知函数均为 $y=y(x) $ 。

我们先介绍解的结构：对于n阶微分方程，其总含有n个常数。常数均为被求出的解被称作**通解**，若其中的常数已被求出，则称之为**特解**。对于一个一般的物理情境，我们通常需要求得其特解，方程内的常数值一般由**初值条件**得到，即x=0时 $y,y',\ldots,y^{(n)} $ 的值。

##### I. 可分离变量的微分方程

可分离变量的方程最终均可改写为下面的形式：

$$
f(y)\mathrm{d}y=g(x)\mathrm{d}x
$$

这时，两侧积分，即得 $F(y)=G(x)+C $ ，这便是方程的通解。

事实上，许多方程经过换元都可以化为可分离变量的微分方程，这需要具体情况具体分析，这里不再赘述其技巧。

##### II. 一阶线性非齐次微分方程

这种方程不可以分离变量，形如

$$
\dot{y}+P(x)y=Q(x)
$$

$Q(x)\neq0 $ 时，方程被称为**非齐次**方程。反之，则被称为**齐次方程**。对于任何一个非齐次方程，都有如下规律：

$$
\text{非齐次通解=齐次通解+非齐次特解}\qquad (*)
$$

其证明我们将会在线性代数中提到，敬请期待。这个规律告诉我们：在已知齐次通解后，我们只需“猜”出非齐次的一个特解即可。

对于注意力没有那么好的人来说，我们引入**常数变易法**。很显然，一阶线性齐次方程是一个可分离变量的方程，其通解为

$$
y=Ce^{-\int P(x)\mathrm{d}x}
$$

所谓常数变易，便是我们认为齐次通解中的常数C是一个关于x的函数C(x)，改变后的函数便是非齐次通解：

$$
y=C(x)e^{-\int P(x)\mathrm{d}x}
$$

这时，将y带入原方程，我们便得以解出 C(x) 。

##### II. 二阶常系数微分方程

二阶方程的情况更为复杂，只有常系数的情况是我们可解的，即形如：

$$
a\ddot{y}+b\dot{y}+cy=f(x)
$$

我们先解决齐次情况，即 $f(x)=0 $

我们在前文提到过， $e^x$ 是导数算符的特征值，因此，我们容易猜出 $e^{rx} $ 组成了方程的解。带入原方程，我们得到了此微分方程的**特征方程**：

$$
ar^2+br+c=0
$$

这是一个一元二次方程，其解被称为**特征根**。

###### (1) $\Delta>0 $

这时，方程有两个解 $r_1,\ r_2 $ 。

方程的通解写作： $y=C_1e^{r_1x}+C_2e^{r_2x} $

###### (2) $\Delta=0 $

这时，方程有重根 $r_0$ 。

利用常数变易法，我们可以求得 $xe^{r_0x} $ 也是方程的解。

因此，方程的通解写作： $y=C_1e^{r_0x}+C_2xe^{r_0x} $ 。

###### (3) $\Delta<0 $

这时，方程有复数根 $x=\frac{-b\pm\mathrm{i}\sqrt{-\Delta}}{2a} $ ，记作 $x=\alpha\pm\beta\mathrm{i} $ 。

因此，方程的通解可以写作 $y=e^{\alpha x}(C_1e^{\beta\mathrm{i}x}+C_2e^{-\beta\mathrm{i}x}) $ 。

这是一个复数形式的解。经过一系列变换（Euler公式，具体原理见“复数”一章），我们可以得到方程的通解为：

$$
y=e^{\alpha x}(C_1\cos\beta x+C_2\sin\beta x)
$$

在物理上，利用辅助角公式，该结果常改写为：

$$
y=e^{\alpha x}A\cos(\omega x+\varphi)
$$

其中的参量均具有一定的物理意义，我们将会在学习简谐运动时再见到他们。

对于非齐次的情况，则需要运用规律（*），利用所求情境的相关性质猜出一非齐次特解后将其与齐次通解相加。

微分方程的情况当然不止这些，物理世界里的微分方程更加纷繁复杂。


#### 0.5.5 泰勒公式(Taylor's Formula)

现实世界总是极为复杂的，但物理学需要通过近似来简单而准确地对其进行描述。泰勒公式给出了一种用多项式来对任意函数进行近似的方法。在任意点 $x_0 $ 附近，函数值总满足公式：

$$
f(x)=f(x_0)+\frac{f'(x_0)}{1!}(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2+\frac{f'''(x_0)}{3!}(x-x_0)^3+\ldots+o(x^n)
$$

最后一项被称为**皮亚诺余项(Peano Remainder)**，其说明了n次多项式的值相比仍有误差。

当 $n\to\infty$ 时，我们称所得多项式为**泰勒级数**，写作：

$$
f(x)=\sum_{n=0}^\infty \frac{f^{(n)}(x_0)}{n!}x^n
$$

泰勒公式的意义在于其用以近似的函数多项式g(x)总满足 $g^{(k)}(x)=f^{(k)}(x) $ 。因此，该多项式并未有很明显的几何意义，更重要的是记住此公式。

若我们恰好需要在 x=0 处对函数进行近似，上面的结论改写为**马克劳林公式\级数(Maclaurin's Formula\Series)**。事实上，这种情况是很常见的。这里给出一些常见初等函数的马克劳林展开，记住他们有一些用处。

$$
\begin{aligned}
&e^x=1+x+\frac{1}{2!}x^2+\frac{1}{3!}x^3+\ldots+\frac{1}{n!}x^n+\ldots\\
&\ln(x+1)=x-\frac{1}{2}x^2+\frac{1}{3}x^3-\frac{1}{4}x^4+\ldots+\frac{(-1)^{n-1}}{n}x^n+\ldots\\
&\sin x=x-\frac{1}{3!}x^3+\frac{1}{5!}x^5-\frac{1}{7!}x^7+\ldots+\frac{(-1)^{n-1}}{2n-1}x^{2n-1}+\ldots\\
&\cos x=1-\frac{1}{2!}x^2+\frac{1}{4!}x^4-\frac{1}{6!}x^6+\ldots+\frac{(-1)^{n}}{2n}x^{2n}+\ldots
\end{aligned}
$$

取第一个含x的项，我们便得到了上述初等函数在 $x\to0$ 处的**等价无穷小**。所谓等价无穷小，就是对函数f(x)，存在多项式g(x)，使 $\lim\frac{f(x)}{g(x)}=1 $ 。在f(x)是**因式**的条件下，等价无穷小可以直接对原函数进行替换。即有：

$$
\begin{aligned}
&e^x\sim x+1\\
&\ln(x+1)\sim x\\
&\sin x\sim x\\
&\cos x\sim 1-\frac{1}{2}x^2
\end{aligned}
$$

作为补充，考虑三角函数的几何定义，我们有

$$
\tan x\sim\sin x\sim x
$$

另外，考虑二项式定理对 $(1+x)^n $ 的展开，只取前两项，有

$$
(1+x)^n\sim 1+nx
$$


在物理上，这个操作被称为**小量代换**，相当有用。我们将逐渐学会如何将其灵活应用。 $\blacksquare$

下一节：[0.6 多元函数微积分](0_6.html)

回到[目录](https://cong344.github.io/physics1/index.html)
