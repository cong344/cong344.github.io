### 0.6 多元函数微积分

在上一节中，我们介绍了对单元函数进行的各种微积分运算。然而，并不是所有系统都可以被简化为只由一个自变量所控制的系统。例如，对于任意理想气体，其热力学量遵从 $pV=\mu RT$ 的理想气体状态方程，这便是一个关于压强、体积、温度的三元函数，可以写作 $f(p,V,T)=0 $ 。本节中，我们将讨论如何对这样的函数进行微积分运算。

#### 0.6.1 多元函数的导数与微分

鉴于对多元极限的讨论必然涉及某些晦涩难懂而又无用的分析学知识，让我们直接跳过极限而了解多元函数的导数。

一个多元函数总能写作 $u=f(x_1,x_2,\ldots,x_n) $ ，这被称为**n元数量值函数**。事实上，我们不难定义**n元m维向量值函数**，因为其中m个分量都可写作 $u_m=f_m(x_1,x_2,\ldots,x_n) $ 。在后文中，我们均使用二元函数 $z=f(x,y) $ 来讨论，其清晰的几何意义有助于理解。对于更多元的函数，其形式与二元几乎相同。

对于多元函数，我们想知道函数值关于*某一个变量*的变化率，由此引出了<b>偏导数(Partial Derivative)</b>的概念。类比导数的定义，偏导数也是一种特殊的极限，其区别在于偏导数将我们不关心的变量设置为了常数，即：

$$
\begin{aligned}
\frac{\partial z}{\partial x}=\lim_{\Delta x\to 0}\frac{f(x+\Delta x,y)-f(x,y)}{\Delta x}\\
\frac{\partial z}{\partial y}=\lim_{\Delta y\to 0}\frac{f(x,y+\Delta y)-f(x,y)}{\Delta y}\\
\end{aligned}
$$

其中符号 $\partial $ 可以看作是微分算符 $\mathrm{d} $ 的某种变体，读作“偏”(partial)。

以 $\frac{\partial z}{\partial x} $ 为例，其几何意义在于： $z=f(x,y) $ 表示一空间曲面，作该曲面关于 $xOz$ 平面的投影曲线， $\frac{\partial z}{\partial x} $ 即为该投影曲线的斜率。

![]()

<center>figure 0.10 偏导数的几何意义</center><br>

然而，需要注意的是，类比单元函数的微分定义直接写出 $\partial z$ 的行为是鲁莽的。对于多元函数，其微小改变量应考虑到各个方向的变化。正因如此，符号 $\partial z$ 没有意义。

由此，我们定义函数 $z=f(x,y) $ 的**全微分**为：

$$
\mathrm{d}z=\frac{\partial z}{\partial x}\mathrm dx+\frac{\partial z}{\partial y}\mathrm dy
$$

除了需要记住要将其他变量视作常数以外，偏导数的求法与单元函数的导数几乎相同，唯一需要简单介绍的是关于复合多元函数的求导方法以及高阶偏导数的求法。


对于复合多元函数，链式法则依然成立，但区别在于链式关系变得更加复杂了。例如，对函数 $z(u(x,y),v(x,y)) $ ：

$$
\frac{\partial z}{\partial x}=\frac{\partial z}{\partial u}\cdot \frac{\partial u}{\partial x} + \frac{\partial z}{\partial v}\cdot\frac{\partial v}{\partial x}
$$

对y的偏导数同理。对更一般的多元隐函数情况，对等式两边同时求偏导可以解决大多数问题。

值得注意的是，**高阶偏导数**的结果是*不唯一*的。这是因为，在对某个变量求一阶导后，我们可以任选其他变量再求一阶导。以二阶导为例，我们有：

$$
\begin{aligned}
\frac{\partial\frac{\partial z}{\partial x}}{\partial x}=\frac{\partial^2 z}{\partial x^2} ,\qquad
&\frac{\partial\frac{\partial z}{\partial x}}{\partial y}=\frac{\partial^2 z}{\partial x\partial y} \\
\frac{\partial\frac{\partial z}{\partial y}}{\partial x}=\frac{\partial^2 z}{\partial y\partial x}  ,\qquad
&\frac{\partial\frac{\partial z}{\partial y}}{\partial y}=\frac{\partial^2 z}{\partial y^2}
\end{aligned}
$$

在物理中，我们所研究的函数均具有足够好的性质，因此总有 $\frac{\partial^2 z}{\partial x\partial y}=\frac{\partial\frac{\partial z}{\partial y}}{\partial x}=\frac{\partial^2 z}{\partial y\partial x} $ ，即求偏导的次序是**可交换**的。

类似利用单元函数导数判断极值的操作，多元函数的偏导数也有此用途，只是形式稍微复杂。对函数 $z=f(x,y)$ ，若点 $P(x_0,y_0)$ 满足：

$$
\begin{cases}
\frac{\partial z}{\partial x}\big\vert_P=0\\
\frac{\partial z}{\partial y}\big\vert_P=0
\end{cases}
$$

则称P点为该函数的**可能极值点**，亦称其为**驻点**。但我们需留意“可能”二字，一个简单的反例是 $z$ 在 $x$ 方向取到极小值，而在 $y$ 方向取到极大值，这样一个类似马鞍面的形状显然不能被认为是极值点。真正的极值点应该形如一个半球面或抛物面，我们可以通过类比重力势能与物体的平衡来理解此问题。

<center>figure 0.11 极值点与非极值点</center><br>

由此，我们引入了 **$\Delta$ 判别法**。对于驻点P，我们定义：

$$
\begin{aligned}
A=\frac{\partial^2 z}{\partial x^2}\Bigg\vert_P,\quad
&B=\frac{\partial^2 z}{\partial x\partial y}\Bigg\vert_P,\quad
C=\frac{\partial^2 z}{\partial y^2}\Bigg\vert_P \\
&\boxed{\Delta=AC-B^2}
\end{aligned}
$$

类似于一元二次方程中根的判别式， $\Delta$ 的正负对应于极值点的存在性：

$$
\begin{cases}
\Delta>0\qquad\text{驻点是极值点}\\
\Delta=0\qquad\text{待进一步判断}\\
\Delta<0\qquad\text{驻点非极值点}\\
\end{cases}
$$

在 $\Delta>0$ 的情况下， $A$ 的正负决定了极值点的性质：

$$
\begin{cases}
A>0\qquad\text{极小值点}\\
A<0\qquad\text{极大值点}
\end{cases}
$$

对于自变量数目更多的函数，我们很少碰到，这时需要使用**黑塞(Hessian)矩阵**进行判断，此处从略。

#### 0.6.2 多元函数的积分

物理学中常常出现对多元函数（多个自变量）的积分。但事实上，解决物理问题时我们一般直接处理的都是其转换为单元积分的形式。因此，我们只需掌握多元积分符号的大致意义，其背后涉及多种类型积分的转换可以简单略去。

事实上，多元函数的积分源自于不同的几何形状，其物理背景均源自于密度与质量的关系。下面将简单介绍源自于不同形状的不同类型积分。

##### I. 线积分

对于一维线度的物体，形如绳子、铁链等，我们定义其单位长度的质量为**线密度**，记为 $\lambda=\frac{\Delta m}{\Delta l}$ ，我们可以用下面的积分计算其总质量，称作**第一型曲线积分**：

$$
M=\int_L \lambda(x,y,z)\cdot\mathrm dl
$$

在空间情况下，计算此积分需要将 $\lambda$ 与 $\mathrm dl$ 均转换为参数方程形式。平面情况下，只需带入 $\lambda$ 的方程以及 $\mathrm dl=\sqrt{1+y'^2}\mathrm dx$ 即可转换为熟悉的一元函数定积分形式。

我们在计算做功时也会遇到这种积分。与上述积分略微不同，这种积分以矢量点乘的形式写出，称为**第二型曲线积分**：

$$
W=\int_L \vec F\cdot\mathrm d\vec l
$$

特别地，若做功路径 $L$ 为一个闭合曲线，即质点在做功后又回到了起点，这时称该积分为**环路积分**。环路积分的符号为即在线积分上添加一个圈。计算环路积分时，常常分段进行计算：

$$
\oint_{\triangle ABC} \vec F\cdot\mathrm d\vec l=
\int_{\overrightarrow{AB}} \vec F\cdot\mathrm d\vec l\ +
\int_{\overrightarrow{BC}} \vec F\cdot\mathrm d\vec l\ +
\int_{\overrightarrow{CA}} \vec F\cdot\mathrm d\vec l
$$

由此可知，第二型曲线积分计算时需要区分其方向。我们将会在场论中学到其更深层次的物理意义。

##### II. 面积分

同样地，对于二维线度的物体，例如薄片、球壳等，我们定义其单位面积的质量为**面密度**，记为 $\sigma=\frac{\Delta m}{\Delta S} $ 。计算这种物体质量的积分称为**第一型曲面积分**：

$$
M=\iint_\Sigma \sigma(x,y,z)\cdot\mathrm dS
$$

一般地， $\Sigma$ 为空间中的一个曲面，需要将其投影在坐标面上。以 $xOy$ 平面为例，设其面积微元为 $\mathrm dA$ ，则两者满足 $\mathrm dS=\frac{\mathrm dA}{\cos \theta}$ ， $\theta$ 为面积微元 $\mathrm dS$ 与 $xOy$ 平面的夹角。投影后在坐标面的积分被称为**二重积分**：

$$
M=\iint_D \sigma(x,y,z)\cdot\mathrm dA
$$

其中，$D$ 为 $\Sigma$ 在坐标面上的投影，两者的关系如图所示： 

<center>figure 曲面积分与二重积分</center><br>

对于二重积分，我们可以根据积分区域 $D$ 将其化为**累次积分**：

$$
\iint_D \sigma(x,y,z)\cdot\mathrm dA
=\int_a^b\mathrm dx\int_{\varphi(x)}^{\psi(x)}\sigma(x,y,z)\mathrm dy
$$

这种累次积分实际上是两个定积分的叠加，因为计算一个积分变量时另一个积分变量可以视为常量，记为：

$$
\int_a^b \left(\int_{\varphi(x)}^{\psi(x)}\sigma(x,y,z)\mathrm dy\right)\mathrm dx
=\int_a^b\mathrm dx\int_{\varphi(x)}^{\psi(x)}\sigma(x,y,z)\mathrm dy
$$

$D$ 区域的图示如下：

<center>figure 二重积分的分解</center><br>

有了一型曲面积分，想必一定有二型曲面积分。二型曲面积分称为**通量积分**，记作 $\displaystyle\iint_\Sigma F\cdot\mathrm d\vec S$ 。我们将会在场论一节中学习其具体物理意义。

##### III. 体积分

对于最常见的自然界中的物体，我们日常生活中所称的“密度”即为其**体密度**，定义为其单位体积的质量，记作 $\rho=\frac{\Delta m}{\Delta V}$ 。计算其质量的积分被称为**三重积分**：

$$
M=\iiint_\Omega \rho(x,y,z)\mathrm dV
$$

事实上，三重积分的计算类似于二重积分，其本质仍为定积分的叠加。
从几何意义上来看，其叠加有两种方法：

考虑一个几何体，先将其对某一面投影（这里以 $xOy$ 面为例），
在该面上取面元，该面元必然对应一个小体积柱。先对该体积柱积分，再将所有面元相加，这种方法被称为**先一后二法**。记作：

$$
\begin{aligned}
\iiint_\Omega \rho(x,y,z)\mathrm dV
&=\iint_D\left(\int_{z_1}^{z_2}\rho(x,y,z)\mathrm dz\right)\mathrm dA\\
&=\iint_D\mathrm dx\mathrm dy\int_{z_1}^{z_2}\rho(x,y,z)\mathrm dz
\end{aligned}
$$

若先将该集合体对某一坐标轴投影（这里以 $z$ 轴为例），在该轴上取线元，该线元对应一个截面。先对该截面进行面积分，再将所有截面积分相加，这种方法被称为**先二后一法**。记作：

$$
\begin{aligned}
\iiint_\Omega \rho(x,y,z)\mathrm dV
&=\int_{z_1}^{z_2}\left(\iint\rho(x,y,z)\mathrm dA\right)\mathrm dz  \\
&=\int_{z_1}^{z_2}\mathrm dz\iint_{D(z)}\rho(x,y,z)\mathrm dx\mathrm dy
\end{aligned}
$$

两种投影的几何意义如下：

<center>figure 三重积分的两种分解</center>

<br>

计算多元函数积分的基本单位便是二重积分与三重积分，他们的本质都是一元函数定积分的叠加。特别地，有时需要对积分区域进行**坐标变换**以达到简化计算的作用，但实际情况中，利用几何意义来实现对运算的简化更加直观、有用，这里便不再介绍。 $\blacksquare$